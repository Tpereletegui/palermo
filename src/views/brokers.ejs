<!DOCTYPE html>
<html lang="en">
    <%- include('./partials/head') -%>
<body>

    <%- include('./partials/navbar') -%>
    <%- include('./partials/float-button') -%>
    
    <section class="section-brokers margin-nav-section" >

        <div class="brokers-title-container section-title-container">
            <div class="section-title">
                <label class="section-title-label" style="color: white; ">
                    <%=brokersDat.title%>
                </label>
            </div>
            <div class="brokers-subtitle-container">
                <p class="brokers-subtitle-text"><%=brokersDat.subtitle%></p>
            </div>
        </div>

        <div class="brokers-container">
            <form action="/brokers" method="post">
                <div class="brokers-subtitle-container-resp">
                    <p class="brokers-subtitle-text-resp"><%=brokersDat.subtitle%></p>
                </div>
                <div class="brokers-programs-container">
                    <div class="broker-field">
                        <input type="radio" name="brokerOption" value="bridge-loan" id="bridge-loan">
                        <label for="bridge-loan" class="program-container-item-icon">
                            <img src="/images/icons/programs/program-1.png" alt="">
                        </label>
                        <h2><%=programsDat.programs[0]%></h2>
                    </div>
    
                    <div class="broker-field">
                        <input type="radio" name="brokerOption" value="fix-flip" id="fix-flip">
                        <label for="fix-flip" class="program-container-item-icon">
                            <img src="/images/icons/programs/program-2.png" alt="">
                        </label>
                        <h2><%=programsDat.programs[1]%></h2>
                    </div>
    
                    <div class="broker-field">
                        <input type="radio" name="brokerOption" value="cash-out" id="cash-out">
                        <label for="cash-out" class="program-container-item-icon">
                            <img src="/images/icons/programs/program-3.png" alt="">
                        </label>
                        <h2><%=programsDat.programs[2]%></h2>
                    </div>
    
                    <div class="broker-field">
                        <input type="radio" name="brokerOption" value="rental" id="rental">
                        <label for="rental" class="program-container-item-icon">
                            <img src="/images/icons/programs/program-4.png" alt="">
                        </label>
                        <h2><%=programsDat.programs[3]%></h2>
                    </div>
                </div>

                <div class="broker-button-contain">
                    <button type="submit" class="principal-button"><%=brokersDat.buttons[0]%></button>
                    <% if(typeof loan != 'undefined'){ %>
                        <a href="./pdf/<%-loan%>.pdf"><button class="principal-button" ><%=brokersDat.buttons[1]%></button></a>
                    <% } %>
                </div>

                <% if(typeof loan != 'undefined'){ %>
                    <div style="display:none;" class="property">
                        <%- loan %>
                    </div>
                    <div class="brokers-pdf-out">
                        <div id="my_pdf_viewer">
                            <div id="canvas_container">
                                <canvas id="pdf_renderer"></canvas>
                            </div>     
                        </div>
                    </div>
                <% } %>        
            </form>
        </div>

        
        
        
                  
    </section>

    <%-include('./partials/footer')%>
    <script>
        var myState = {
            pdf: null,
            currentPage: 2,
            zoom: 1.31
        }

        var loadP = document.querySelector(".property");
        var loan; 
        if (loadP){
            loan = loadP.innerHTML.trim();

        }
        let screenW = window.screen.width;


        if (screenW < 768 && screenW > 576){
            myState.zoom = 0.82;
        } else if (screenW < 576){
            myState.zoom = 0.5;
        }

        console.log(loan);
        if (loan){
            pdfjsLib.getDocument('pdf/'+loan+'.pdf').then(pdf =>{
        
            myState.pdf = pdf;
            render();
            })
        }

        function render() {
            myState.pdf.getPage(myState.currentPage).then((page) => {

                var canvas = document.getElementById("pdf_renderer");
                var ctx = canvas.getContext('2d');

                var viewport = page.getViewport(myState.zoom);
                canvas.width = viewport.width;
                canvas.height = viewport.height;

                page.render({
                    canvasContext: ctx,
                    viewport: viewport
                });
            });
        }

        

    </script>
    <script src="/js/navbarLinks.js"></script>
    <script src="/js/navbarResponsive.js"></script>
</body>
</html>